<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Machine d'Interprétation Lexicale — BST-404</title>

  <style>
    :root{
      --bg:#070606;
      --panel:#0b0b0b;
      --accent:#d44a2e;    /* rouge ocre */
      --warm:#f2c27d;      /* or/ambre */
      --muted:#8a7a6b;
      --glass: rgba(255,255,255,0.02);
    }
    html,body{height:100%;margin:0;font-family: "Share Tech Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;}
    body{
      background: linear-gradient(180deg,#050505 0%, #0b0b0b 100%);
      color:#efe9e3;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
    }

    /* wrapper & device centered */
    .wrapper{ width:100%; height:100vh; display:flex; align-items:center; justify-content:center; }
    .device {
      width:92vw;
      max-width:520px;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.12));
      border: 1px solid rgba(140,30,18,0.9);
      border-radius:14px;
      box-shadow: 0 12px 48px rgba(0,0,0,0.8);
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:12px;
      align-items:center;
    }

    .header {
      width:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:6px;
    }
    .title {
      font-size:1.05rem;
      color:var(--warm);
      letter-spacing:1.6px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .subtitle {
      font-size:0.76rem;
      color:var(--muted);
      text-align:center;
    }

    .screen {
      width:100%;
      background: linear-gradient(180deg, rgba(140,30,18,0.02), rgba(0,0,0,0.06));
      border-radius:10px;
      padding:12px;
      min-height:140px;
      box-sizing:border-box;
      color:#f7efd9;
      font-family: monospace;
      font-size:13px;
      line-height:1.4;
      position:relative;
      overflow:hidden;
    }

    /* scanlines overlay */
    .screen::after{
      content:"";
      position:absolute; left:0; right:0; top:0; bottom:0;
      background-image: repeating-linear-gradient(180deg, rgba(255,255,255,0.006) 0, rgba(0,0,0,0.00) 1px);
      pointer-events:none;
      mix-blend-mode:overlay;
    }

    .console {
      white-space:pre-wrap;
      max-height:220px;
      overflow:hidden;
      display:block;
    }

    .controls {
      width:100%;
      display:flex;
      flex-direction:column;
      gap:10px;
      align-items:center;
      margin-top:6px;
    }

    input[type="text"]{
      width:86%;
      padding:12px 14px;
      border-radius:10px;
      background:#111;
      color:#ffd;
      border:1px solid rgba(255,255,255,0.02);
      font-size:16px;
      text-transform:uppercase;
      text-align:center;
      outline:none;
    }

    .row {
      width:100%;
      display:flex;
      justify-content:center;
      gap:10px;
    }

    button {
      padding:10px 14px;
      border-radius:10px;
      border:none;
      background: linear-gradient(180deg,var(--accent), #8b1e12);
      color:#0b0a08;
      font-weight:700;
      cursor:pointer;
      box-shadow: 0 8px 18px rgba(212,74,46,0.18);
      font-size:15px;
    }

    .status {
      width:88%;
      text-align:center;
      padding:8px 10px;
      border-radius:8px;
      font-family:monospace;
      font-size:13px;
      display:none;
    }
    .status.ok { background: rgba(242,194,125,0.09); color:var(--warm); display:flex; justify-content:center;}
    .status.err { background: rgba(212,74,46,0.06); color:#ffbebe; display:flex; justify-content:center;}

    .footer {
      width:100%;
      display:flex;
      justify-content:space-between;
      font-size:12px;
      color:var(--muted);
      padding-top:6px;
      border-top:1px solid rgba(255,255,255,0.02);
    }

    .ornament {
      width:76px; height:56px; border-radius:8px; overflow:hidden;
      display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.06);
      border:1px solid rgba(255,255,255,0.02);
    }
    .ornament img{ max-width:72px; max-height:48px; opacity:0.95; }

    /* small shake */
    @keyframes shake { 0%{transform:translateX(0)}20%{transform:translateX(-6px)}40%{transform:translateX(6px)}60%{transform:translateX(-4px)}80%{transform:translateX(2px)}100%{transform:translateX(0)} }

    @media (min-width:680px){
      .device{ max-width:480px; }
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="device" role="application" aria-label="Machine d'Interprétation Lexicale BST-404">
      <div class="header">
        <div class="title">
          Machine d'Interprétation Lexicale
        </div>
        <div class="subtitle">Machine non homologuée - Manuels de bord restreints.</div>
      </div>

      <div class="screen" id="screen" aria-live="polite">
        <div class="console" id="console">
[BOOT] Initialisation du sous-système BST-404...
[BOOT] Chargement du dictionnaire lexical...
[BOOT] Chargement de l'interpréteur sémantique...
[BOOT] Synchronisation temporelle : stable
[ÉTAT] Scanner prêt.
        </div>
      </div>

      <div class="controls">
        <div style="display:flex;gap:8px;align-items:center;">
            <div style="font-size:13px;color:var(--muted)">Saisir un mot-clé connu par le dispositif</div>
        </div>

        <div class="row">
          <input id="decodeInput" type="text" placeholder="ENTRER LE MOT-CLÉ" autocomplete="off" />
        </div>
        <div class="row">
          <button id="decodeBtn">DÉCODER</button>
        </div>

        <div id="status" class="status" role="status" aria-live="polite"></div>
      </div>

      <div class="footer">
        <div> Sous-système BST-404 </div>
        <div> Firmware v1.4-ht </div>
      </div>
    </div>
  </div>

  <!-- sons : place tes fichiers dans assets/ok.mp3, assets/error.mp3, assets/scan.mp3 -->
  <audio id="soundOk" src="assets/ok.mp3" preload="auto"></audio>
  <audio id="soundError" src="assets/error.mp3" preload="auto"></audio>
  <audio id="soundScan" src="assets/scan.mp3" preload="auto"></audio>

  <script>
    // ====== ROUTES (mot -> page) ======
    const ROUTES = {
      "CECILE":"ugrtn8f5gtggT6.html"
    };

    // UI
    const input = document.getElementById('decodeInput');
    const btn = document.getElementById('decodeBtn');
    const consoleEl = document.getElementById('console');
    const statusEl = document.getElementById('status');

    // audio
    const sOk = document.getElementById('soundOk');
    const sErr = document.getElementById('soundError');
    const sScan = document.getElementById('soundScan');

    // helper: write with small type effect (fast)
    function writeConsole(text, fast = false){
      const base = fast ? 10 : 30;
      consoleEl.textContent = '';
      let i=0;
      const t = setInterval(()=> {
        consoleEl.textContent += text[i] || '';
        i++;
        if(i>text.length) clearInterval(t);
      }, base);
    }

    // generate random garbage characters to display while scanning
    function randomGarbage(len=80){
      const chars = "!@#$%^&*()_+{}[]<>?/|\\~-=0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      let s='';
      for(let i=0;i<len;i++){
        s += chars.charAt(Math.floor(Math.random()*chars.length));
      }
      return s;
    }

    // play sound safe
    function play(audio){
      if(!audio) return;
      try{ audio.currentTime = 0; audio.play().catch(()=>{}); }catch(e){}
    }

    function analyseWord(word){
      // show scanning + garbage
      writeConsole("[ANALYSE] Interprétation lexicale en cours...\n[CORR] " + randomGarbage(64));
      play(sScan);

      // progressive percentage
      let pct=4;
      const tick = setInterval(()=>{
        pct += Math.floor(Math.random()*10)+4; // small increments
        if(pct>98) pct = 99;
        consoleEl.textContent = "[ANALYSE] Interprétation lexicale en cours...\n[CORR] " + pct + "%";
      }, 260);

      // total analysis time (adjust to taste)
      const totalTime = 1600; // ms
      setTimeout(()=>{
        clearInterval(tick);
        const k = word.trim().toUpperCase();
        if(ROUTES[k]){
          success(k);
        } else {
          fail(k);
        }
      }, totalTime);
    }

    function success(key){
      statusEl.className = "status ok";
      statusEl.style.display = "flex";
      statusEl.textContent = "TERME AUTHENTIFIÉ — PRÉPARATION OUVERTURE FRAGMENT";
      play(sOk);
      // show final console then redirect
      writeConsole("[TERME] " + key + " — AUTHENTIFICATION COMPLÉTÉE\n[ROUTE] Ouverture du fragment...");
      setTimeout(()=> {
        // redirect
        window.location.href = ROUTES[key];
      }, 2500);
    }

    function fail(key){
      statusEl.className = "status err";
      statusEl.style.display = "flex";
      statusEl.textContent = "ERREUR LEXICALE — ANOMALIE HORS-RÉFÉRENTIEL";
      play(sErr);
      // shake effect via CSS transform
      const dev = document.querySelector('.device');
      dev.style.animation = "shake 0.28s";
      setTimeout(()=> dev.style.animation = "", 1000);

      writeConsole("[ERREUR] " + key + " — AUCUNE CORRESPONDANCE\n[ÉTAT] Remise à zéro en cours...");
      setTimeout(()=>{
        statusEl.style.display = "none";
        writeConsole("[ÉTAT] Scanner prêt.\n");
      }, 2500);
    }

    // wire
    btn.addEventListener('click', ()=>{
      const v = input.value || "";
      if(!v.trim()){
        writeConsole("[ALERTE] Aucun terme détecté. Entrez un mot-clé.");
        statusEl.style.display = "none";
        return;
      }
      analyseWord(v);
    });

    input.addEventListener('keypress', (e)=>{
      if(e.key === 'Enter') btn.click();
    });

    // initial focus and short boot animation (done only once per page load)
    window.addEventListener('load', ()=>{
      input.focus();
      // small boot sequence: show initial lines gradually
      const bootText = "[BOOT] Initialisation du sous-système BST-404...\n" +
        "[BOOT] Chargement du dictionnaire lexical...\n" +
        "[BOOT] Chargement de l'interpréteur sémantique...\n" +
        "[BOOT] Synchronisation temporelle : stable\n" +
        "[ÉTAT] Scanner prêt.\n";
      writeConsole(bootText, true);
    });
  </script>
</body>
</html>
