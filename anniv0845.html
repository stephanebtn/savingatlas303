<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Transmission – Message crypté</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div id="intro">
    <p id="introText">Connexion au canal 404Δ...<br><small>(Appuyez pour activer)</small></p>
    <div class="glitch-lines"></div>
  </div>

  <h1 id="title" style="opacity:0;">Canal 404Δ – Message crypté</h1>

  <div class="player-container" id="mainContent" style="opacity:0;">
    <p>Décryptage en cours…</p>
    <div id="transmissionText" class="terminal"></div>
  </div>

  <div class="footer">Bureau de Sauvegarde Temporelle – 2050</div>

  <script>
// === Configuration ===
const PHONE = "+33668666240"; // ⚠️ TON VRAI NUMÉRO ICI
const APIKEY = "8941906"; // ⚠️ TON VRAI API KEY CALLMEBOT ICI
const WORKER_URL = "https://a303.stephane-btn.workers.dev";

// === Description du fragment ===
// ⚠️ A CHANGER pour chaque page différente
const fragmentId = "fragment_1"; // Unique: fragment_1, fragment_2, fragment_3...
const fragmentName = "Fragment 1 (salle principale)"; // Nom lisible pour WhatsApp

// === Détection de l'équipe ===
const params = new URLSearchParams(window.location.search);
const team = params.get("team") || "UNKNOWN";

// === Envoi WhatsApp avec cache ===
if (team !== "UNKNOWN") {
    const msg = encodeURIComponent(`TEAM ${team} a trouvé ${fragmentName}`);
    
    const url = `${WORKER_URL}?phone=${PHONE}&apikey=${APIKEY}&text=${msg}&team=${team}&fragment=${fragmentId}`;
    
    fetch(url)
        .then(response => {
            if (response.ok) {
                console.log("✅ Notification envoyée");
            }
        })
        .catch(() => {
            // Ignore les erreurs CORS (normal)
        });
}



    const intro = document.getElementById('intro');
    const mainContent = document.getElementById('mainContent');
    const title = document.getElementById('title');
    const textContainer = document.getElementById('transmissionText');
    const message = "Bonjour Agent Ziva. En ce 20 novembre 2025 toute l'agence vous souhaite un bon anniversaire. Vous avez recu un nouveaut mot clé : ANNIVERSAIRE";

    intro.addEventListener("click", () => {
      intro.style.opacity = 0;
      setTimeout(() => { intro.style.display = "none"; }, 1000);
      title.style.transition = "opacity 1s";
      mainContent.style.transition = "opacity 1s";
      title.style.opacity = 1;
      mainContent.style.opacity = 1;
      typeWriterEffect(message);
    });

    function typeWriterEffect(text) {
      let i = 0;
      textContainer.textContent = "";
      const interval = setInterval(() => {
        textContainer.textContent += text[i];
        i++;
        if (i >= text.length) clearInterval(interval);
      }, 40);
    }
  </script>
</body>
</html>

